{"code":"import { defineComponent } from \"vue\";\nimport { ref, onMounted } from 'vue';\nexport default defineComponent({\n    setup() {\n        const keyword = ref('');\n        const searchResults = ref([]);\n        const hotTags = ref(['餐厅', '酒店', '超市', '医院', '银行', '学校', '加油站', '停车场']);\n        const searchHistory = ref([]);\n        const lat = ref(0);\n        const lng = ref(0);\n        const debounceTimer = ref(null);\n        onMounted(() => {\n            const pages = getCurrentPages();\n            const currentPage = pages[pages.length - 1];\n            const options = currentPage.options;\n            lat.value = parseFloat(options.lat) || 39.9042;\n            lng.value = parseFloat(options.lng) || 116.4074;\n            loadSearchHistory();\n        });\n        const loadSearchHistory = () => {\n            const history = uni.getStorageSync('mapSearchHistory') || [];\n            searchHistory.value = history;\n        };\n        const onInput = () => {\n            clearTimeout(debounceTimer.value);\n            debounceTimer.value = setTimeout(() => {\n                if (keyword.value.trim()) {\n                    searchPOI(keyword.value);\n                }\n                else {\n                    searchResults.value = [];\n                }\n            }, 300);\n        };\n        const searchPOI = (keyword = null) => {\n            // 实际项目中应调用地图API或后端接口\n            searchResults.value = [\n                new UTSJSONObject({\n                    id: '1',\n                    name: `${keyword}测试地点1`,\n                    address: '北京市海淀区测试地址1',\n                    latitude: lat.value + (Math.random() * 0.01 - 0.005),\n                    longitude: lng.value + (Math.random() * 0.01 - 0.005)\n                }),\n                new UTSJSONObject({\n                    id: '2',\n                    name: `${keyword}测试地点2`,\n                    address: '北京市海淀区测试地址2',\n                    latitude: lat.value + (Math.random() * 0.01 - 0.005),\n                    longitude: lng.value + (Math.random() * 0.01 - 0.005)\n                })\n            ];\n        };\n        const searchTag = (tag = null) => {\n            keyword.value = tag;\n            searchPOI(tag);\n        };\n        const selectLocation = (item = null) => {\n            const history = uni.getStorageSync('mapSearchHistory') || [];\n            const index = history.findIndex((h = null) => { return h.id === item.id; });\n            if (index >= 0) {\n                history.splice(index, 1);\n            }\n            history.unshift(item);\n            if (history.length > 10) {\n                history.pop();\n            }\n            uni.setStorageSync('mapSearchHistory', history);\n            uni.navigateBack(new UTSJSONObject({\n                delta: 1,\n                success: () => {\n                    const eventChannel = getOpenerEventChannel();\n                    eventChannel.emit('selectLocation', item);\n                }\n            }));\n        };\n        const clearKeyword = () => {\n            keyword.value = '';\n            searchResults.value = [];\n        };\n        const goBack = () => {\n            uni.navigateBack();\n        };\n        return new UTSJSONObject({\n            keyword,\n            searchResults,\n            hotTags,\n            searchHistory,\n            onInput,\n            searchTag,\n            selectLocation,\n            clearKeyword,\n            goBack\n        });\n    }\n});\n//# sourceMappingURL=/Users/xyhc/Documents/carConnectInternet/pages/search/search.uvue?vue&type=script&lang.uts.js.map","references":["/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts"],"uniExtApis":["uni.getStorageSync","uni.setStorageSync","uni.navigateBack"],"map":"{\"version\":3,\"file\":\"search.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"search.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
