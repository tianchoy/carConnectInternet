{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport mpMixin from '@/uni_modules/uv-ui-tools/libs/mixin/mpMixin.js';\nimport mixin from '@/uni_modules/uv-ui-tools/libs/mixin/mixin.js';\nimport props from './props.js';\n/**\n * gridItem 提示\n * @description 宫格组件一般用于同时展示多个同类项目的场景，可以给宫格的项目设置徽标组件(badge)，或者图标等，也可以扩展为左右滑动的轮播形式。搭配uv-grid使用\n * @tutorial https://www.uvui.cn/components/grid.html\n * @property {String | Number}\tname\t\t宫格的name ( 默认 null )\n * @property {String}\t\t\tbgColor\t\t宫格的背景颜色 （默认 'transparent' ）\n * @property {Object}\t\t\tcustomStyle\t自定义样式，对象形式\n * @event {Function} click 点击宫格触发\n * @example <uv-grid-item></uv-grid-item>\n */\nexport default defineComponent({\n    name: \"uv-grid-item\",\n    mixins: [mpMixin, mixin, props],\n    emits: ['$uvGridItem', 'click'],\n    data() {\n        return {\n            parentData: new UTSJSONObject({\n                col: 3,\n                border: true, // 是否显示边框，根据父组件决定\n            }),\n            classes: [], // 类名集合，用于判断是否显示右边和下边框\n        };\n    },\n    created() {\n        // 父组件的实例\n        this.updateParentData();\n    },\n    mounted() {\n        this.init();\n    },\n    computed: {\n        // vue下放到computed中，否则会因为延时造成闪烁\n        width() {\n            return 100 / Number(this.parentData.col) + '%';\n        },\n        itemStyle() {\n            const style = new UTSJSONObject({\n                background: this.bgColor,\n                width: this.width\n            });\n            return this.$uv.deepMerge(style, this.$uv.addStyle(this.customStyle));\n        }\n    },\n    methods: {\n        init() {\n            // 用于在父组件uv-grid的children中被添加入子组件时，\n            // 重新计算item的边框\n            uni.$on('$uvGridItem', () => {\n                this.gridItemClasses();\n            });\n            // 发出事件，通知所有的grid-item都重新计算自己的边框\n            uni.$emit('$uvGridItem');\n            this.gridItemClasses();\n        },\n        // 获取父组件的参数\n        updateParentData() {\n            // 此方法写在mixin中\n            this.getParentData('uv-grid');\n        },\n        clickHandler() {\n            var _a;\n            let name = this.name;\n            // 如果没有设置name属性，历遍父组件的children数组，判断当前的元素是否和本实例this相等，找出当前组件的索引\n            const children = (_a = this.parent) === null || _a === void 0 ? null : _a.children;\n            if (children && this.name === null) {\n                name = children.findIndex((child = null) => { return child === this; });\n            }\n            // 调用父组件方法，发出事件\n            this.parent && this.parent.childClick(name);\n            this.$emit('click', name);\n        },\n        getItemWidth() {\n            return __awaiter(this, void 0, void 0, function* () {\n                // 如果是nvue，不能使用百分比，只能使用固定宽度\n                let width = 0;\n                if (this.parent) {\n                    // 获取父组件宽度后，除以栅格数，得出每个item的宽度\n                    const parentWidth = yield this.getParentWidth();\n                    width = parentWidth / Number(this.parentData.col) + 'px';\n                }\n                this.width = width;\n            });\n        },\n        // 获取父元素的尺寸\n        getParentWidth() {\n        },\n        gridItemClasses() {\n            if (this.parentData.border) {\n                let classes = [];\n                this.parent.children.map((child = null, index = null) => {\n                    if (this === child) {\n                        const len = this.parent.children.length;\n                        // 贴近右边屏幕边沿的child，并且最后一个（比如只有横向2个的时候），无需右边框\n                        if ((index + 1) % this.parentData.col !== 0 && index + 1 !== len) {\n                            classes.push('uv-border-right');\n                        }\n                        // 总的宫格数量对列数取余的值\n                        // 如果取余后，值为0，则意味着要将最后一排的宫格，都不需要下边框\n                        const lessNum = len % this.parentData.col === 0 ? this.parentData.col : len % this.parentData.col;\n                        // 最下面的一排child，无需下边框\n                        if (index < len - lessNum) {\n                            classes.push('uv-border-bottom');\n                        }\n                    }\n                });\n                // 支付宝，头条小程序无法动态绑定一个数组类名，否则解析出来的结果会带有\",\"，而导致失效\n                this.classes = classes;\n            }\n        }\n    },\n    unmounted() {\n        // 移除事件监听，释放性能\n        uni.$off('$uvGridItem');\n    }\n});\n//# sourceMappingURL=/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-grid/components/uv-grid-item/uv-grid-item.vue?vue&type=script&lang.uts.js.map","references":["/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-ui-tools/libs/mixin/mpMixin.js","/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-ui-tools/libs/mixin/mixin.js","/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-grid/components/uv-grid-item/props.js"],"uniExtApis":["uni.$on","uni.$emit","uni.$off"],"map":"{\"version\":3,\"file\":\"uv-grid-item.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"uv-grid-item.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
