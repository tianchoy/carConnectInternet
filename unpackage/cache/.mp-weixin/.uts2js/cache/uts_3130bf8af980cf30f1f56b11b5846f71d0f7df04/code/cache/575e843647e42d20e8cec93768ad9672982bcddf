{"code":"import { __awaiter, __read } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport mpMixin from '@/uni_modules/uv-ui-tools/libs/mixin/mpMixin.js';\nimport mixin from '@/uni_modules/uv-ui-tools/libs/mixin/mixin.js';\nimport uvBadgeProps from '@/uni_modules/uv-badge/components/uv-badge/props.js';\nimport props from './props.js';\n/**\n * Tabs 标签\n * @description tabs标签组件，在标签多的时候，可以配置为左右滑动，标签少的时候，可以禁止滑动。 该组件的一个特点是配置为滚动模式时，激活的tab会自动移动到组件的中间位置。\n * @tutorial https://www.uvui.cn/components/tabs.html\n * @property {Array}\tlist\t标签数组，元素为对象，如[{name: '推荐'}]\n * @property {String | Number}\tduration\t\t\t滑块移动一次所需的时间，单位秒（默认 200 ）\n * @property {String | Object} activeStyle\t菜单选择中时的样式（默认{ color: '#303133' }）\n * @property {String | Object} inactiveStyle\t菜单非选择中时的样式（默认{ color: '#606266' }）\n * @property {String | Number} lineWidth\t滑块长度（默认 20）\n * @property {String | Number} lineHeight\t滑块高度（默认 3）\n * @property {String}\tlineColor\t滑块颜色（默认：'#3c9cff'）\n * @property {String} lineBgSize\t滑块背景显示大小，当滑块背景设置为图片时使用（默认 cover）\n * @property {String | Number} itemStyle\t菜单item的样式（默认 { height: '44px' }）\n * @property {String}\tscrollable\t菜单是否可滚动，选项很少的时候设置为false整个tabs自动居中显示（默认：true）\n * @property {String | Number}\tcurrent\t当前选中标签的索引（默认 0 ）\n * @property {String}\tkeyName\t从list元素对象中读取的键名（默认 'name' ）\n * @property {String | Number}\tswierWidth\t\t\tswiper的宽度（默认 '750rpx' ）\n * @property {String | Object}\tcustomStyle\t 自定义外部样式\n *\n * @event {Function(index)} change 标签改变时触发 index: 点击了第几个tab，索引从0开始\n * @event {Function(index)} click 点击标签时触发 index: 点击了第几个tab，索引从0开始\n * @example <uv-tabs :list=\"list\" :is-scroll=\"false\" :current=\"current\" @change=\"change\"></uv-tabs>\n */\nexport default defineComponent({\n    name: 'uv-tabs',\n    emits: ['click', 'change'],\n    mixins: [mpMixin, mixin, props],\n    data() {\n        return {\n            firstTime: true,\n            scrollLeft: 0,\n            scrollViewWidth: 0,\n            lineOffsetLeft: 0,\n            tabsRect: new UTSJSONObject({\n                left: 0\n            }),\n            innerCurrent: 0,\n            moving: false,\n        };\n    },\n    watch: {\n        current: {\n            immediate: true,\n            handler(newValue = null, oldValue = null) {\n                // 内外部值不相等时，才尝试移动滑块\n                if (newValue !== this.innerCurrent) {\n                    this.innerCurrent = newValue;\n                    this.$nextTick(() => {\n                        this.resize();\n                    });\n                }\n            }\n        },\n        // list变化时，重新渲染list各项信息\n        list() {\n            this.$nextTick(() => {\n                this.resize();\n            });\n        }\n    },\n    computed: {\n        textStyle() {\n            return (index = null) => {\n                const style = new UTSJSONObject({}\n                // 取当期是否激活的样式\n                );\n                // 取当期是否激活的样式\n                const customeStyle = index == this.innerCurrent ? this.$uv.addStyle(this.activeStyle) : this.$uv\n                    .addStyle(this.inactiveStyle);\n                // 如果当前菜单被禁用，则加上对应颜色，需要在此做处理，是因为nvue下，无法在style样式中通过!import覆盖标签的内联样式\n                if (this.list[index].disabled) {\n                    style.color = '#c8c9cc';\n                }\n                return this.$uv.deepMerge(customeStyle, style);\n            };\n        },\n        propsBadge() {\n            return uvBadgeProps;\n        }\n    },\n    mounted() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.init();\n        });\n    },\n    methods: {\n        setLineLeft() {\n            const tabItem = this.list[this.innerCurrent];\n            if (!tabItem) {\n                return null;\n            }\n            // 获取滑块该移动的位置\n            let lineOffsetLeft = this.list\n                .slice(0, this.innerCurrent)\n                .reduce((total = null, curr = null) => { return total + curr.rect.width; }, 0);\n            // 获取下划线的数值px表示法\n            let lineWidth = this.$uv.getPx(this.lineWidth);\n            // 如果传的值未带单位+设置了全局单位，则带上单位计算，这样才没有误差\n            if (this.$uv.test.number(this.lineWidth) && this.$uv.unit) {\n                lineWidth = this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`);\n            }\n            this.lineOffsetLeft = lineOffsetLeft + (tabItem.rect.width - lineWidth) / 2;\n            // 如果是第一次执行此方法，让滑块在初始化时，瞬间滑动到第一个tab item的中间\n            // 这里需要一个定时器，因为在非nvue下，是直接通过style绑定过渡时间，需要等其过渡完成后，再设置为false(非第一次移动滑块)\n            if (this.firstTime) {\n                setTimeout(() => {\n                    this.firstTime = false;\n                }, 20);\n            }\n        },\n        // nvue下设置滑块的位置\n        animation(x = null, duration = 0) {\n        },\n        // 点击某一个标签\n        clickHandler(item = null, index = null) {\n            // 因为标签可能为disabled状态，所以click是一定会发出的，但是change事件是需要可用的状态才发出\n            this.$emit('click', new UTSJSONObject(Object.assign(Object.assign({}, item), { index })));\n            // 如果disabled状态，返回\n            if (item.disabled)\n                return null;\n            if (this.innerCurrent != index) {\n                this.$emit('change', new UTSJSONObject(Object.assign(Object.assign({}, item), { index })));\n            }\n            this.innerCurrent = index;\n            this.$nextTick(() => {\n                this.resize();\n            });\n        },\n        init() {\n            this.$uv.sleep().then(() => {\n                this.resize();\n            });\n        },\n        setScrollLeft() {\n            // 当前活动tab的布局信息，有tab菜单的width和left(为元素左边界到父元素左边界的距离)等信息\n            const tabRect = this.list[this.innerCurrent];\n            // 累加得到当前item到左边的距离\n            const offsetLeft = this.list\n                .slice(0, this.innerCurrent)\n                .reduce((total = null, curr = null) => {\n                return total + curr.rect.width;\n            }, 0);\n            // 此处为屏幕宽度\n            const windowWidth = this.$uv.sys().windowWidth;\n            // 将活动的tabs-item移动到屏幕正中间，实际上是对scroll-view的移动\n            let scrollLeft = offsetLeft - (this.tabsRect.width - tabRect.rect.width) / 2 - (windowWidth - this.tabsRect\n                .right) / 2 + this.tabsRect.left / 2;\n            // 这里做一个限制，限制scrollLeft的最大值为整个scroll-view宽度减去tabs组件的宽度\n            scrollLeft = Math.min(scrollLeft, this.scrollViewWidth - this.tabsRect.width);\n            this.scrollLeft = Math.max(0, scrollLeft);\n        },\n        // 获取所有标签的尺寸\n        resize() {\n            // 如果不存在list，则不处理\n            if (this.list.length === 0) {\n                return null;\n            }\n            Promise.all([this.getTabsRect(), this.getAllItemRect()]).then((_a) => {\n                var _b = __read(_a, 2), tabsRect = _b[0], _c = _b[1], itemRect = _c == void 0 ? [] : _c;\n                this.tabsRect = tabsRect;\n                this.scrollViewWidth = 0;\n                itemRect.map((item = null, index = null) => {\n                    // 计算scroll-view的宽度，这里\n                    this.scrollViewWidth += item.width;\n                    // 另外计算每一个item的中心点X轴坐标\n                    this.list[index].rect = item;\n                });\n                // 获取了tabs的尺寸之后，设置滑块的位置\n                this.setLineLeft();\n                this.setScrollLeft();\n            });\n        },\n        // 获取导航菜单的尺寸\n        getTabsRect() {\n            return new Promise(resolve => {\n                this.queryRect('uv-tabs__wrapper__scroll-view').then((size = null) => { return resolve(size); });\n            });\n        },\n        // 获取所有标签的尺寸\n        getAllItemRect() {\n            return new Promise(resolve => {\n                const promiseAllArr = this.list.map((item = null, index = null) => { return this.queryRect(`uv-tabs__wrapper__nav__item-${index}`, true); });\n                Promise.all(promiseAllArr).then((sizes = null) => { return resolve(sizes); });\n            });\n        },\n        // 获取各个标签的尺寸\n        queryRect(el = null, item = null) {\n            // $uvGetRect为uni-ui自带的节点查询简化方法，详见文档介绍：https://www.uvui.cn/js/getRect.html\n            // 组件内部一般用this.$uvGetRect，对外的为getRect，二者功能一致，名称不同\n            return new Promise(resolve => {\n                this.$uvGetRect(`.${el}`).then((size = null) => {\n                    resolve(size);\n                });\n            });\n        },\n    },\n});\n//# sourceMappingURL=/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-tabs/components/uv-tabs/uv-tabs.vue?vue&type=script&lang.uts.js.map","references":["/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-ui-tools/libs/mixin/mpMixin.js","/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-ui-tools/libs/mixin/mixin.js","/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-badge/components/uv-badge/props.js","/Users/xyhc/Documents/carConnectInternet/uni_modules/uv-tabs/components/uv-tabs/props.js"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"uv-tabs.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"uv-tabs.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
